webpackJsonp([3],{"0xDb":function(e,t,r){"use strict";t.a=a;var o=r("pFYg"),n=r.n(o);function a(e,t){if(0===arguments.length)return null;var r=t||"{y}-{m}-{d} {h}:{i}:{s}",o=void 0;"object"===(void 0===e?"undefined":n()(e))?o=e:("string"==typeof e&&/^[0-9]+$/.test(e)&&(e=parseInt(e)),"number"==typeof e&&10===e.toString().length&&(e*=1e3),o=new Date(e));var a={y:o.getFullYear(),m:o.getMonth()+1,d:o.getDate(),h:o.getHours(),i:o.getMinutes(),s:o.getSeconds(),a:o.getDay()};return r.replace(/{([ymdhisa])+}/g,function(e,t){var r=a[t];return"a"===t?["日","一","二","三","四","五","六"][r]:r.toString().padStart(2,"0")})}},Ic9w:function(e,t,r){"use strict";t.b=function(e){return Object(o.a)({url:"/insertJourney",method:"post",data:e})},t.e=function(e){return Object(o.a)({url:"/updateJourney",method:"post",data:e})},t.a=function(e){return Object(o.a)({url:"/deleteJourney",method:"post",data:e})},t.d=function(){return Object(o.a)({url:"/queryJourneysByUserId",method:"get"})},t.c=function(e){return Object(o.a)({url:"/queryJourneys",method:"post",data:e})};var o=r("0jG4")},hkWN:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("Ic9w"),n={data:function(){var e=this;return{typeOptions:[{value:0,label:"飞机"},{value:1,label:"火车"},{value:2,label:"其他"}],journeyForm:this.defaultJourneyForm(),journeyRules:{fromCity:[{required:!0,message:"请输入出发城市",trigger:"change"}],toCity:[{required:!0,message:"请输入目的城市",trigger:"change"},{validator:function(t,r,o){r===e.journeyForm.fromCity&&o(new Error("出发地和目的地相同")),o()},trigger:"change"}],departDate:[{required:!0,message:"请选择出发时间",trigger:"blur"}],type:[{required:!0,message:"请输入目的城市",trigger:"change"}]}}},props:["journey"],methods:{defaultJourneyForm:function(){return{departDate:null,fromCity:"",toCity:"",type:0,note:""}},validate:function(){this.journeyForm.fromCity=this.journeyForm.fromCity.trim(),this.journeyForm.toCity=this.journeyForm.toCity.trim()},clearJourneyForm:function(){this.journeyForm=this.defaultJourneyForm()},handleUpdateJourney:function(){var e=this;this.$refs.journeyForm.validate(function(t){if(t){var r={journeyId:e.journey.journeyId,departDate:e.journeyForm.departDate,fromCity:e.journeyForm.fromCity,toCity:e.journeyForm.toCity,type:e.journeyForm.type,note:e.journeyForm.note};Object(o.e)(r).then(function(t){!0===t&&(e.$emit("handleJourney"),e.$message({showClose:!0,message:"修改成功",type:"success"}))})}})},handleInsertJourney:function(){var e=this;this.$refs.journeyForm.validate(function(t){if(t){var r={departDate:e.journeyForm.departDate,fromCity:e.journeyForm.fromCity,toCity:e.journeyForm.toCity,type:e.journeyForm.type,note:e.journeyForm.note};Object(o.b)(r).then(function(t){t>0&&(e.$emit("handleJourney"),e.$message({showClose:!0,message:"添加成功",type:"success"}))})}})}},mounted:function(){this.journey&&(this.journeyForm.departDate=new Date(this.journey.departDate),this.journeyForm.fromCity=this.journey.fromCity,this.journeyForm.toCity=this.journey.toCity,this.journeyForm.type=this.journey.type,this.journeyForm.note=this.journey.note)}},a={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-form",{ref:"journeyForm",attrs:{"label-position":"left","label-width":"100px",model:e.journeyForm,rules:e.journeyRules}},[r("el-form-item",{attrs:{label:"出发时间",prop:"departDate"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择出发时间"},model:{value:e.journeyForm.departDate,callback:function(t){e.$set(e.journeyForm,"departDate",t)},expression:"journeyForm.departDate"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"出发城市",prop:"fromCity"}},[r("el-input",{staticClass:"city_input",attrs:{placeholder:"请输入出发地",clearable:""},on:{change:e.validate},model:{value:e.journeyForm.fromCity,callback:function(t){e.$set(e.journeyForm,"fromCity",t)},expression:"journeyForm.fromCity"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"到达城市",prop:"toCity"}},[r("el-input",{staticClass:"city_input",attrs:{placeholder:"请输入目的地",clearable:""},on:{change:e.validate},model:{value:e.journeyForm.toCity,callback:function(t){e.$set(e.journeyForm,"toCity",t)},expression:"journeyForm.toCity"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"出行方式",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择出行方式"},model:{value:e.journeyForm.type,callback:function(t){e.$set(e.journeyForm,"type",t)},expression:"journeyForm.type"}},e._l(e.typeOptions,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"备注"}},[r("el-input",{staticClass:"city_input",attrs:{type:"textarea",placeholder:"航班/车次信息",clearable:""},model:{value:e.journeyForm.note,callback:function(t){e.$set(e.journeyForm,"note",t)},expression:"journeyForm.note"}})],1),e._v(" "),e.journey?r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleUpdateJourney}},[e._v("修改")]):r("el-button",{attrs:{type:"primary",plain:""},on:{click:e.handleInsertJourney}},[e._v("添加")]),e._v(" "),r("el-button",{attrs:{plain:""},on:{click:e.clearJourneyForm}},[e._v("清空")])],1)],1)},staticRenderFns:[]},u=r("VU/8")(n,a,!1,null,null,null).exports,l=r("0xDb"),i={data:function(){return{journeys:[],showSaveJourney:!1,selectedJourney:null,typeOptions:[{type:"primary",label:"飞机"},{type:"success",label:"火车"},{type:"info",label:"其它"}]}},mounted:function(){this.handleQueryJourneysByUserId()},methods:{toSaveJourney:function(e){this.selectedJourney=e,this.showSaveJourney=!0},handleJourney:function(){this.showSaveJourney=!1,this.handleQueryJourneysByUserId()},parseTime:function(e){return null==e?"":Object(l.a)(e,"{y}-{m}-{d} {h}:{i}")},handleDeleteJourney:function(e){var t=this;Object(o.a)(e).then(function(e){!0===e&&(t.$message({showClose:!0,message:"删除成功",type:"success"}),t.handleQueryJourneysByUserId())})},handleQueryJourneysByUserId:function(){var e=this;Object(o.d)().then(function(t){e.journeys=t})}},components:{SaveJourney:u}},s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticStyle:{"margin-top":"20px"}},[r("el-button",{attrs:{type:"success",plain:""},on:{click:function(t){return e.toSaveJourney(null)}}},[e._v("添加出行记录")])],1),e._v(" "),r("div",{staticStyle:{"margin-top":"20px"}},[r("el-table",{attrs:{data:e.journeys,stripe:""}},[r("el-table-column",{attrs:{prop:"fromCity",label:"出发地",width:"80"}}),e._v(" "),r("el-table-column",{attrs:{prop:"toCity",label:"目的地",width:"80"}}),e._v(" "),r("el-table-column",{attrs:{label:"出发日期",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return r("span",{},[e._v(e._s(e.parseTime(t.row.departDate)))])}}])}),e._v(" "),r("el-table-column",{attrs:{label:"出行方式"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:e.typeOptions[t.row.type].type,size:"medium"}},[e._v("\n            "+e._s(e.typeOptions[t.row.type].label)+"\n          ")])]}}])}),e._v(" "),r("el-table-column",{attrs:{prop:"note",label:"备注"}}),e._v(" "),r("el-table-column",{attrs:{fixed:"right",label:"操作",width:"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit-outline",plain:""},on:{click:function(r){return e.toSaveJourney(t.row)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-delete",plain:""},on:{click:function(r){return e.handleDeleteJourney(t.row)}}})]}}])})],1)],1),e._v(" "),r("div",[r("el-dialog",{attrs:{visible:e.showSaveJourney},on:{"update:visible":function(t){e.showSaveJourney=t}}},[e.showSaveJourney?r("SaveJourney",{attrs:{journey:e.selectedJourney},on:{handleJourney:e.handleJourney}}):e._e()],1)],1)])},staticRenderFns:[]},y=r("VU/8")(i,s,!1,null,null,null);t.default=y.exports}});